<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Missing data lecture 8: Likelihood-based inference with incomplete data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-fd68462179fdb1eb8400a3e2e38edf1e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>
window.MathJax = {
  startup: {
    ready() {
      MathJax.startup.defaultReady();
      const {STATE} = MathJax._.core.MathItem;
      MathJax.tex2mml(String.raw`
      \newcommand{\R}{\mathbb{R}}
      \newcommand{\comp}{\mathsf{c}}
        \newcommand{\lp}{\left(}
        \newcommand{\rp}{\right)}
        \newcommand{\lb}{\left[}
        \newcommand{\rb}{\right]}
        \newcommand{\ind}[1]{\mathbbm{1}\lp#1\rp}
        \newcommand{\Exp}[1]{\mathbb{E} \lb #1 \rb}
        \newcommand{\ExpA}[2]{\mathbb{E}_{#2} \lb #1 \rb}
        \newcommand{\Var}[1]{\text{Var} \lp #1 \rp}
        \newcommand{\VarA}[2]{\text{Var}_{#2} \lp #1 \rp}
        \newcommand{\indy}{\mathrel{\unicode{x2AEB}}}
        \newcommand{\Prob}[2]{\mathbb{P}_{#2} \lp #1 \rp}
        \newcommand{\abs}[1]{\left| #1 \right|}
        \newcommand{\norm}[1]{\left\lVert #1 \right\rVert}
      `);
    }
  },
  loader: {load: ['[tex]/bbm']},
  tex: {packages: {'[+]': ['bbm']}}
};
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@4.1/tex-mml-chtml.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../papers.html"> 
<span class="menu-text">My papers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Random thoughts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../courses.html"> 
<span class="menu-text">Courses</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#likelihood-inference-with-incomplete-data" id="toc-likelihood-inference-with-incomplete-data" class="nav-link active" data-scroll-target="#likelihood-inference-with-incomplete-data">Likelihood inference with incomplete data</a></li>
  <li><a href="#example-incomplete-exponential-sample" id="toc-example-incomplete-exponential-sample" class="nav-link" data-scroll-target="#example-incomplete-exponential-sample">Example: Incomplete exponential sample</a></li>
  <li><a href="#missing-data-example-parameter-distinctness" id="toc-missing-data-example-parameter-distinctness" class="nav-link" data-scroll-target="#missing-data-example-parameter-distinctness">Missing data example: Parameter distinctness</a></li>
  <li><a href="#partial-mar" id="toc-partial-mar" class="nav-link" data-scroll-target="#partial-mar">Partial MAR</a></li>
  <li><a href="#example-regression-with-missing-data" id="toc-example-regression-with-missing-data" class="nav-link" data-scroll-target="#example-regression-with-missing-data">Example: Regression with missing data</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Missing data lecture 8: Likelihood-based inference with incomplete data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="likelihood-inference-with-incomplete-data" class="level3">
<h3 class="anchored" data-anchor-id="likelihood-inference-with-incomplete-data">Likelihood inference with incomplete data</h3>
<p>We said that the likelihood function is really a set of functions that are proportional the probability density such that the constant of proportionality doesn’t depend the parameters.</p>
<p>Missing data methods distinguish themselves from other methods by modeling the joint distribution of <span class="math inline">\(Y\)</span> and <span class="math inline">\(M\)</span>. Let <span class="math inline">\(y\)</span> represent a possible set of values for <span class="math inline">\(Y\)</span> and let <span class="math inline">\(m\)</span> represent an element in the space <span class="math inline">\(\{0,1\}^{n \times K}\)</span>, the missingness indicators for all <span class="math inline">\(i\)</span> units. Let <span class="math inline">\(\theta \in \Omega_\theta\)</span> be parameters that govern the marginal distribution of the data: <span class="math inline">\(f_Y(y \mid \theta)\)</span> and <span class="math inline">\(\phi \in \Omega_\phi\)</span> be parameters that govern the missingness mechanism: <span class="math inline">\(f_{M \mid Y}(M = m \mid Y = y, \phi)\)</span>.</p>
<p>Then the joint distribution for these RVs, <span class="math inline">\(f_{Y,M}(y,m \mid \theta, \phi)\)</span> can be written as the product of the marginal distribution for the data and the conditional distribution :</p>
<p><span class="math display">\[
f_{Y,M}(y, M = m \mid \theta, \phi) = f_{Y}(y \mid \theta) f_{M \mid Y}(M = m \mid Y = y, \phi)
\]</span> When we have missing data, we can partition the matrix <span class="math inline">\(y\)</span> into <span class="math inline">\(y_{(1)}\)</span> and <span class="math inline">\(y_{(0)}\)</span>, representing the components of <span class="math inline">\(y\)</span> that are missing and observed, respectively.</p>
<p>Let <span class="math inline">\(\mathcal{Y}\)</span> be the sample space for <span class="math inline">\(y_i\)</span> and let <span class="math inline">\(\mathcal{Y}_{(1)}\)</span> and <span class="math inline">\(\mathcal{Y}_{(0)}\)</span> be the sample space for the missing and observed components of <span class="math inline">\(y\)</span>.</p>
<p>Then the distribution of the observed data is: <span class="math display">\[
\int_{\mathcal{Y}_{(1)}} f_{Y,M}(y, M = m \mid \theta, \phi) dy_{(1)} = \int_{\mathcal{Y}_{(1)}} f_{Y}(y_{(0)},y_{(1)}  \mid \theta) f_{M \mid Y}(M = m \mid Y_{(0)} = y_{(0)},Y_{(1)} = y_{(1)}, \phi)dy_{(1)}
\]</span> This joint density is proportional to what we’ll call the full-data likelihood:</p>
<p><span class="math display">\[
L_{\text{full}}(\theta, \phi \mid \tilde{y}_{(0)}, \tilde{m}) = \int_{\mathcal{Y}_{(1)}} f_{Y}(\tilde{y}_{(0)},y_{(1)}  \mid \theta) f_{M \mid Y}(M = \tilde{m} \mid Y_{(0)} = \tilde{y}_{(0)},Y_{(1)} = y_{(1)}, \phi)dy_{(1)}
\]</span> We can also compute the likelihood the missingness process:</p>
<p><span class="math display">\[
L_{\text{ign}}(\theta \mid \tilde{y}_{(0)}) = \int_{\mathcal{Y}_{(1)}} f_{Y}(\tilde{y}_{(0)},y_{(1)}  \mid \theta) dy_{(1)}
\]</span> We’ll say that the missingness mechanism is if inferences based on <span class="math inline">\(L_{\text{ign}}(\theta \mid \tilde{y}_{(0)})\)</span> and <span class="math inline">\(L_{\text{full}}(\theta, \phi \mid \tilde{y}_{(0)}, \tilde{m})\)</span> are the same given <span class="math inline">\(\tilde{m}, \tilde{y}_{(0)}\)</span>.</p>
<p>Formally, the missingness mechanism is ignorable for direct likelihood inference if the likelihood ratios for any two <span class="math inline">\(\theta, \theta^*\)</span> given <span class="math inline">\(\tilde{m}, \tilde{y}_{(0)}\)</span> are equal: <span class="math display">\[
\frac{L_{\text{full}}(\theta, \phi \mid \tilde{y}_{(0)}, \tilde{m})}{L_{\text{full}}(\theta^*, \phi \mid \tilde{y}_{(0)}, \tilde{m})} = \frac{L_{\text{ign}}(\theta \mid \tilde{y}_{(0)})}{L_{\text{ign}}(\theta^* \mid \tilde{y}_{(0)})} \forall \theta, \theta^*, \phi
\]</span> There are two sufficient conditions that ensure ignorability:</p>
<ol type="1">
<li><p>Parameters <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\phi\)</span> are <em>variationally independent</em>, i.e.&nbsp;the joint parameter space <span class="math inline">\(\Omega_{\theta,\phi} = \Omega_\theta \times \Omega_\phi\)</span></p></li>
<li><p>The full likelihood factorizes as <span class="math display">\[
L_{\text{full}}(\theta, \phi \mid \tilde{y}_{(0)}, \tilde{m}) = L_{\text{ign}}(\theta \mid \tilde{y}_{(0)}) L_\text{rest}(\phi \mid \tilde{y}_{(0)}, \tilde{m})
\]</span> The first condition is sufficient to ensure that the value of <span class="math inline">\(\phi\)</span> doesn’t lead to a different likelihood value for <span class="math inline">\(\theta\)</span> vs.&nbsp;<span class="math inline">\(\theta^*\)</span>.</p></li>
</ol>
<p>If the data are MAR, then we will satisfy the second condition:</p>
<p><span class="math display">\[
f_{M \mid Y} (M = \tilde{m} \mid Y_{(0)} = \tilde{y}_{(0)}, Y_{(1)} = y_{(1)}, \phi) = f_{M \mid Y} (M = \tilde{m} \mid Y_{(0)} = \tilde{y}_{(0)}, Y_{(1)} = y_{(1)}^*, \phi)
\]</span> for all <span class="math inline">\(y_{(1)}, y_{(1)}^*, \phi\)</span>. Then we can write the full-likelihood as: <span class="math display">\[
f_{M \mid Y}(M = \tilde{m} \mid Y_{(0)}=\tilde{y}_{(0)}, \phi) \int_{\mathcal{Y}_{(1)}} f_{Y}(\tilde{y}_{(0)},y_{(1)}  \mid \theta) dy_{(1)} = f_{M \mid Y}(M = \tilde{m} \mid Y_{(0)} = \tilde{y}_{(0)}, \phi)  f_{Y}(\tilde{y}_{(0)}  \mid \theta)
\]</span> Then by the above theorem, parameter distinctness and MAR are sufficient for ignorability.</p>
<p>When we do Bayesian inference we need to ensure that the posterior for <span class="math inline">\(\theta\)</span> when using the ignorable likelihood is equal to the posterior for <span class="math inline">\(\theta\)</span> when using the full likelihood. Under the full likleihood, the posterior for <span class="math inline">\((\theta, \phi)\)</span> is:</p>
<p><span class="math display">\[
p(\theta, \phi \mid y_{(0)},m) \propto p(\theta, \phi) L_{\text{full}}(\theta, \phi \mid y_{(0)}, m)
\]</span> and under the ignorable likelihood we have:</p>
<p><span class="math display">\[
p(\theta \mid \tilde{y}_{(0)},\tilde{m}) \propto p(\theta) L_{\text{ign}}(\theta \mid \tilde{y}_{(0)})
\]</span> Thus, sufficient conditions for the posteriors to be equal is that</p>
<ol type="1">
<li><p><span class="math inline">\(p(\theta, \phi) = p(\theta)p(\phi)\)</span>, or the prior independence of <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\phi\)</span></p></li>
<li><p>The full likelihood factorizes as <span class="math display">\[
L_{\text{full}}(\theta, \phi \mid \tilde{y}_{(0)}, \tilde{m}) = L_{\text{ign}}(\theta \mid \tilde{y}_{(0)}) L_\text{rest}(\phi \mid \tilde{y}_{(0)}, \tilde{m})
\]</span></p></li>
</ol>
</section>
<section id="example-incomplete-exponential-sample" class="level3">
<h3 class="anchored" data-anchor-id="example-incomplete-exponential-sample">Example: Incomplete exponential sample</h3>
<p>Let <span class="math inline">\(y_i \overset{\text{iid}}{\sim} \text{Exponential}(\theta)\)</span> for <span class="math inline">\(i = 1, \dots, n\)</span>. Let <span class="math inline">\(m_i\)</span> be the missingness indicators, and suppose <span class="math inline">\(r = \sum_{i=1}^n (1 - m_i)\)</span>. The full likelihood is <span class="math display">\[
f_Y(y \mid \theta) = \theta^{-n}\exp\lp-\sum_{i=1}^n y_i / \theta \rp
\]</span> Let <span class="math inline">\(y_{(0)} = (y_1, \dots, y_r)\)</span> and <span class="math inline">\(y_{(1)} = (y_{r+1}, \dots, y_n)\)</span>. The likelihood that ignores the likelihood is <span class="math display">\[
L_{\text{ign}}(\theta \mid y_{(0)}) = \theta^{-r} \exp\lp-\sum_{i=1}^r y_i / \theta \rp
\]</span> Let <span class="math inline">\(m_i \overset{\text{iid}}{\sim} \text{Bernoulli}(\phi)\)</span>, so <span class="math display">\[
f_{M \mid Y}(m \mid y, \phi) = \phi^{r}(1 - \phi)^{n-r}
\]</span> Then <span class="math inline">\(f(y_{(0)}, m \mid \theta, \phi) = \phi^{r}(1 - \phi)^{n-r}\theta^{-r} \exp\lp-\sum_{i=1}^r y_i / \theta \rp\)</span>, which factorizes into a factor related to <span class="math inline">\(\theta\)</span> and a factor related to <span class="math inline">\(\phi\)</span>. This means we can base inferences on <span class="math inline">\(\theta\)</span> on <span class="math inline">\(L_{\text{ign}}(\theta \mid y_{(0)}\)</span> instead of the full likelihood. The MLE is <span class="math inline">\(\hat{\theta} = \sum_{i=1}^n y_i / r\)</span>.</p>
<p>Now suppose we observe only observations for which <span class="math inline">\(y_i \leq c\)</span>, so <span class="math display">\[
f(m_i \mid y_i, \phi) = \ind{y_i \geq c}^{m_i}\ind{y_i &lt; c}^{1 - m_i}
\]</span> Putting this together, the full likelihood is: <span class="math display">\[
\prod_{i=1}^r f_{Y}(y_i \mid \theta) \ind{y_i &lt; c} \prod_{i={r+1}}^n \int_{\R^+} \ind{y_i \geq c} f(y \mid \theta) dy
\]</span></p>
<p>Which of course simplifies to <span class="math display">\[
\theta^{-r} \exp\lp-\sum_{i=1}^r y_i / \theta \rp\exp(-(n - r) c / \theta)
\]</span> This shows that the missingness is nonignorable, because the full likelihood isn’t equal to the ignorable likelihood we used in the first part of the problem.</p>
<p>The log-likelihood is: <span class="math display">\[
\ell(\theta \mid y_{(0)}, m) = -r \log \theta - \sum_{i=1}^r y_i / \theta - (n - r) c / \theta
\]</span></p>
<p><span class="math display">\[
\frac{\partial \ell(\theta \mid y_{(0)}, m)}{\partial \theta} = -r/\theta + \sum_{i=1}^r y_i / \theta^2 + (n - r) c / \theta^2
\]</span> Setting this equal to zero and solving for <span class="math inline">\(\theta\)</span> gives the MLE: <span class="math display">\[
\hat{\theta} = \frac{\sum_{i=1}^r y_i + (n - r) c}{r}
\]</span> This of course doesn’t equal the ignorable MLE, <span class="math inline">\(\bar{y}\)</span> for the observed values.</p>
</section>
<section id="missing-data-example-parameter-distinctness" class="level3">
<h3 class="anchored" data-anchor-id="missing-data-example-parameter-distinctness">Missing data example: Parameter distinctness</h3>
<p>Suppose <span class="math inline">\(y_{ij}, \{i = 1, \dots, n\}, \{j = 1, \dots, n_i\}\)</span> are univariate normal with mean <span class="math inline">\(\alpha_i\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>. Let <span class="math inline">\(\theta = (\sigma^2, \tau^2, \mu)\)</span>: <span class="math display">\[
\begin{aligned}
y_{ij} \mid \alpha_i, \theta &amp; \sim \text{Normal}(\alpha_i, \sigma^2) \\
\alpha_i \mid \theta &amp; \sim \text{Normal}(\mu, \tau^2)
\end{aligned}
\]</span> Let the missingness mechanism be: <span class="math display">\[
f_{M \mid Y}(m_{ij} \mid y, \alpha_i, \phi) = \pi(\alpha_i, \phi) = (1 + e^{-(\phi_0 + \phi_1 \alpha_i)})^{-1}
\]</span> The joint density of the observations and parameters, also known as the complete data likelihood, is: <span class="math display">\[
\begin{aligned}
\prod_{i=1}^I \lp\prod_{j=1}^{n_i} \frac{1}{\sqrt{2 \pi\sigma^2}} e^{-\frac{1}{2\sigma^2}(y_{ij} - \alpha_i)^2} \pi(\alpha_i,\phi)^{m_{ij}}(1 - \pi(\alpha_i,\phi))^{1-m_{ij}}\rp \frac{1}{\sqrt{2 \pi\sigma^2}} e^{-\frac{1}{2\sigma^2}(\alpha_i - \mu)^2}
\end{aligned}
\]</span> Because the <span class="math inline">\(\alpha_i\)</span> aren’t observed, but do have a density, we need to integrate over them to compute the full likelihood: <span class="math display">\[
\begin{aligned}
\prod_{i=1}^I \int_{\R} \prod_{j=1}^{n_i} \lp \frac{1}{\sqrt{2 \pi\sigma^2}} e^{-\frac{1}{2\sigma^2}(y_{ij} - \alpha_i)^2}\rp^{1 - m_{ij}} \pi(\alpha_i,\phi)^{m_{ij}}(1 - \pi(\alpha_i,\phi))^{1-m_{ij}} \frac{1}{\sqrt{2 \pi\sigma^2}} e^{-\frac{1}{2\sigma^2}(\alpha_i - \mu)^2}d\alpha_i
\end{aligned}
\]</span> This shows that the missingness process isn’t ignorable here, even though we don’t technically have the distribution of missingness depending on missing obesrvable data, per se. This shows that in some sense, <span class="math inline">\(\alpha_i\)</span> is missing data, and, indeed, this is what our textbook considers missing data; namely anything that has a distribution that is unobserved. This makes the problem MNAR.</p>
<p>Compare this to the ANOVA model with the same missingness mechanism: <span class="math display">\[
\begin{aligned}
y_{ij} \mid \alpha_i, \theta &amp; \sim \text{Normal}(\alpha_i, \sigma^2)
\end{aligned}
\]</span> Then the joint likelihood is <span class="math display">\[
\begin{aligned}
\prod_{i=1}^I \prod_{j=1}^{n_i} \frac{1}{\sqrt{2 \pi\sigma^2}} e^{-\frac{1}{2\sigma^2}(y_{ij} - \alpha_i)^2} \pi(\alpha_i,\phi)^{m_{ij}}(1 - \pi(\alpha_i,\phi))^{1-m_{ij}}
\end{aligned}
\]</span> This shows that the data are MAR, because the missingness mechanism doesn’t depend on missing data. However, the parameters for the missingness mechanism and the observations don’t satisfy the distinctness condition, so the missingness is nonignorable.</p>
</section>
<section id="partial-mar" class="level3">
<h3 class="anchored" data-anchor-id="partial-mar">Partial MAR</h3>
<p>Suppose we can partition <span class="math inline">\(\theta\)</span> into two pieces, <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span> so that the parameter of interest is <span class="math inline">\(\theta_1\)</span>. The data are partially MAR for <span class="math inline">\(\theta_1\)</span> if we can factorize the full likelihood: <span class="math display">\[
L_{\text{full}}(\theta_1, \theta_2, \phi \mid y_{(0)}, m) = L_1(\theta \mid y_{(0)}) L_{\text{rest}}(\theta_2, \phi \mid y_{(0)}, m)
\]</span></p>
</section>
<section id="example-regression-with-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="example-regression-with-missing-data">Example: Regression with missing data</h3>
<p>An example of this is when we have covariates paired with each observation so that the complete data is <span class="math inline">\((y_i, x_i), i = 1, \dots, n\)</span> where <span class="math inline">\(y_i \in \R^d\)</span> and <span class="math inline">\(x_i \in \R^p\)</span>. let <span class="math inline">\(y_{(0)},y_{(1)}\)</span> be the observed and missing elements of <span class="math inline">\(y_i\)</span> and <span class="math inline">\(x_{(0)},x_{(1)}\)</span> are the observed and missing elements of <span class="math inline">\(x_i\)</span>. Let <span class="math inline">\(m^X_{i}\)</span> be the missingness indicators for the covariates, <span class="math inline">\(X\)</span>, and let <span class="math inline">\(m^Y_i\)</span> be the missingness indicators for the observations <span class="math inline">\(y_i\)</span>. Let <span class="math inline">\(m_i = (m^Y_{i},m^X_{i})\)</span> be the combined missingness indicators for unit <span class="math inline">\(i\)</span>. Suppose that for <span class="math inline">\(i=1, \dots, r\)</span> <span class="math inline">\(x_i\)</span> is fully observed, while at least one component of <span class="math inline">\(y_i\)</span> is observed, and for the remaining <span class="math inline">\(i = r+1, \dots, n\)</span> <span class="math inline">\(y_i\)</span> is completely missing and each <span class="math inline">\(x_i\)</span> has at least one missing component. Let <span class="math inline">\(y_i, x_i, m_i\)</span> be unit iid, so: <span class="math display">\[
f_{Y,X,M} (y_i, x_i, m_i \mid \theta_1, \theta_2, \phi) = f_{Y \mid X}(y_i \mid x_i, \theta_1) f_{X}(x_i \mid \theta_2) f_{M \mid Y, X}(m_i \mid y_i, x_i, \phi)
\]</span> We’ll assume the missingness mechanism takes the following form: <span class="math display">\[
f_{M\mid Y, X}(m_i \mid x_{i(1)}, x_{i(0)}, y_i, \phi) = f_{M\mid Y, X}(m_i \mid x_{i(1)}, x_{i(0)}, y_i^{\star}, \phi)
\]</span> for all <span class="math inline">\(y_i, y_i^\star, x_{i(0)}, i = 1, \dots, n\)</span>.</p>
<p>This missingness mechanism is MNAR because it depends on unobserved components of <span class="math inline">\(x_{i(1)}\)</span>. Luckily we’ll be able to factorize our likelihood so inference <span class="math inline">\(\theta_1\)</span> is partially ignorable: <span class="math display">\[
L_{\text{full}}(\theta_1, \theta_2, \phi \mid y_{(0)}, x_{(0)}, m) = L_{\text{p-ign}}(\theta_1 \mid y_{(0)}, x_{(0)}) L_{\text{rest}}(\theta_2, \phi \mid m, x_{(0)})
\]</span> Let <span class="math inline">\(\mathcal{Y}_i\)</span> be the sample space corresponding to the missing <span class="math inline">\(y_{i(1)}\)</span>. Then we can write the ignorable part of the likelihood: <span class="math display">\[
L_{\text{p-ign}}(\theta_1 \mid y_{(0)}, x_{(0)}) = \prod_{i=1}^r \int_{\mathcal{Y}_i} f_{Y\mid X}(y_{i(0)}, y_{i(1)} \mid x_i, \theta_1) dy_{i(1)}
\]</span> Let <span class="math inline">\(\mathcal{X}_i\)</span> be the sample space of the missing covariates for the <span class="math inline">\(i^\mathrm{th}\)</span> unit. Then the rest of the likelihood can be written as <span class="math display">\[
L_{\text{rest}}(\theta_2, \phi \mid x_{i(0)}, m) =\prod_{i=1}^r f_X(x_i \mid \theta_2) f_{M \mid X}(m_i \mid x_i, \phi) \prod_{i=r+1}^n \int_{\mathcal{X}_i} f_{X}(x_{i(0)}, x_{i(1)} \mid \theta_2) f_{M \mid X} (m_i \mid x_{i(1)}, x_{i(0)}, \phi) dx_{i(1)}
\]</span> Note the book has a typo here.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>